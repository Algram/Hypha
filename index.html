<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="assets/normalize.css">
    <link rel="stylesheet" href="style.css">
    <script src="assets/jquery-2.1.4.min.js" onload="window.$ = window.jQuery = module.exports;"></script>
    <title>Hello World!</title>
  </head>
  <body>
    <!--<div id="titlebar">
        <a href="#" class="close-thick"></a>
    </div>-->

    <div id="content"></div>

    <div id="writeArea">
        <input type="text" name="message" id="messageInput">
    </div>
    <script>
        'use strict';
        const ipcRenderer = require('electron').ipcRenderer;

        /*ipcRenderer.on('asynchronous-reply', function(event, arg) {
          console.log(arg);
      });*/

        $("#messageInput").keyup(function (e) {
            if (e.keyCode == 13) {
                let message = $(this).val();

                if (message != '') {
                    let line = '<p><span id="from">' + 'Algram' + '</span>' + message + '</p>';
                    $('#content').append(line);
                    $("#content").animate({ scrollTop: $("#content")[0].scrollHeight}, 0);

                    ipcRenderer.send('messageSent', message);
                    $(this).val('');
                }
            }
        });

        ipcRenderer.on('messageReceived', function(event, from, to, message) {
            let line = '<p><span id="from">' + from + '</span>' + message + '</p>';
            $('#content').append(line);
            $("#content").animate({ scrollTop: $("#content")[0].scrollHeight}, 0);
        });
    </script>
  </body>
</html>
